@using System.Security.Claims
@using Microsoft.AspNetCore.Identity
@inject UserManager<Users> UserManager
@{
    ViewData["Title"] = "User Panel";
}
<style>
    .fajna {
        background-color: #212121;
        border-color: #0f0f0f;
        border-radius: 5px;
        width: 70%;
        padding: 20px;
        border-width: 5px;
        margin: 20px;
        margin-left: 15%;
        text-align: left;
    }

    .center {
        text-align: center;
        color: #3b3b3b
    }

</style>
@{
    var user = await UserManager.GetUserAsync(User);

    var post_count = 0;
}

@model OLX.ViewModels.PostsWithComments

<div class="text-center">
    <h1 class="display-4">Witaj <b>@user.FullName.ToUpper()!</b></h1>
    <h2 class="display-6">Zarządzaj Postami!</h2>
    <a asp-action="Transakcje">historia transakcji</a>
    <hr />
</div>


@foreach (var post in Model.Posts)
{
    if (post.User == user)
    {
        {post_count+=1;}

        <div class="fajna">
            <p>@post.Title</p>
            @if (post.Picture != null && post.Picture.Length > 0)
            {
                var img = "data:image/png;base64," + Convert.ToBase64String(post.Picture);
                <img src="@img" width="60px" height="60px" />
                <b><hh>ㅤ @post.Price zł</hh></b>
                <b>ㅤ</b>
            }
            <a asp-action="Create" asp-route-id="@post.Id" asp-route-picture="@post.Picture">Edit</a>
            <a asp-action="Delete" asp-route-id="@post.Id">Delete</a>
            <a asp-controller="Home" asp-action="Details" asp-route-id="@post.Id">Preview</a>
        </div>
    }
}

@if (post_count <= 0)
{
    <div class="center">
        <p>Oho! nic tu nie ma!</p>
        <a class="btn btn-primary" asp-action="Create" asp-controller="Home">Dodaj Post!</a>
    </div>
    
}
